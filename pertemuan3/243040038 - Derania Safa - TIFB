--menampilkan semua data pada tabel product
SELECT * 
FROM Production.Product;

--menampilkan Name, ProductNumber, dan ListPrice
SELECT Name, ProductNumber, ListPrice 
FROM Production.Product;

--menampilkan data menggunakan  alias kolom
SELECT Name AS [Nama Barang], ListPrice AS 'Harga Jual'
FROM Production.Product;

--menampilkan HargaBaru = ListPrice * 1.1
SELECT Name, ListPrice, (ListPrice * 1.1) AS HargaBaru
FROM Production.Product;

--menampilkan data dengan menggabungkan string 
SELECT Name + '(' + ProductNumber + ')' AS ProdukLengkap
FROM Production.Product;

--filterisasi data
--menampilkan produk yang berwarna 'red'
SELECT Name, Color, ListPrice
FROM Production.Product
WHERE Color = 'red';

--menampilkan produk yang ListPrice nya lebih dari 1000
SELECT Name, ListPrice
FROM Production.Product
WHERE ListPrice > 1000;

--menampilkan produk yang berwarna black dan list price nya lebih dari 500
SELECT Name, Color, ListPrice
FROM Production.Product
WHERE Color = 'black' AND ListPrice > 500;

--menampilkan produk yang berwarna red, blue, ATAU black
SELECT Name, Color
FROM Production.Product
WHERE Color IN ('red', 'blue', 'black');

--menampilkan produk yang namanya mengandung kata 'Road'
SELECT Name, ProductNumber
FROM Production.Product
WHERE Name LIKE '%Road%';  --hapus % didepan jika ingin kata Road nya didepan saja, begitupun sebaliknya

--agregasi dan pengelompokkan
--menghitung total baris
SELECT COUNT(*) AS TotalProduk
FROM Production.Product;

--menampilkan warna produk dan jumlahnya
SELECT Color, COUNT(*) AS JumlahProduk
FROM Production.Product
GROUP BY Color;

--menampilkan ProductID, jumkah OrderQTY, dan rata2 UnitPrice
SELECT ProductID, SUM(OrderQTY) AS TotalPenjual, AVG(UnitPrice) AS RataRataHarga
FROM Sales.SalesOrderDetail
GROUP BY ProductID;

SELECT * 
FROM Sales.SalesOrderDetail;

--menampilkan data dengan grouping lebih dari satu kolom
SELECT Color, Size, COUNT(*) AS Jumlah
FROM Production.Product
GROUP BY Color, Size;

SELECT * 
FROM Production.Product;

--filter hasil agregasi
--menampilkan warna produk yang jumlahnya lebih dari 20
SELECT Color, COUNT(*) AS Jumlah
FROM Production.Product
GROUP BY Color
HAVING COUNT(*) > 2;

--menampilkan warna produk yang ListPricenya > 500 dan jumlahnya > 10
SELECT Color, COUNT(*) AS Jumlah
FROM Production.Product
WHERE ListPrice > 500
GROUP BY Color
HAVING COUNT(*) < 1;

--menampilkan ProductID yang jumlah OrderQty nya lebih dari 100
SELECT ProductID, SUM(OrderQTY) AS RataRataBeli
FROM Sales.SalesOrderDetail
GROUP BY ProductID
HAVING SUM(OrderQTY) > 10;

--menampilkan specialOfferID yang rata2 OrderQty nya kurang dari 2
SELECT SpecialOfferID, AVG(OrderQTY) AS RataRataBeli
FROM Sales.SalesOrderDetail
GROUP BY SpecialOfferID
HAVING AVG(OrderQTY) > 2;

--menampilkan warna yang listpricenya lebih dari 3000 menggunakan MAX
SELECT Color
FROM Production.Product
GROUP BY Color
HAVING MAX(ListPrice) > 3000;

--Advanced Select dan Order By
--menampilkan JobTitle tanpa duplikat
SELECT DISTINCT JobTitle 
FROM HumanResources.Employee;

SELECT JobTitle
FROM HumanResources.Employee;

--menampilkan 5 nama produk termahal
SELECT TOP 5 Name, ListPrice
FROM Production.Product
ORDER BY ListPrice DESC;

--menampilkan 5 nama produk termurah
SELECT TOP 5 Name, ListPrice
FROM Production.Product
ORDER BY ListPrice ASC;

--OFFSET FETCH
SELECT Name, ListPrice
FROM Production.Product
ORDER BY ListPrice DESC
OFFSET 2 ROWS
FETCH NEXT 4 ROWS ONLY;

SELECT Name, ListPrice
FROM Production.Product
ORDER BY ListPrice DESC

SELECT TOP 3 Color, SUM(ListPrice) AS TotalNilaiStok
FROM Production.Product
WHERE ListPrice > 0
GROUP BY Color
ORDER BY TotalNilaiStok DESC;

--TUGAS MANDIRI
--1. 
SELECT ProductID, SUM(LineTotal) AS TotalUang  
FROM Sales.SalesOrderDetail
GROUP BY ProductID;

--2.
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
WHERE OrderQTY >= 2
GROUP BY ProductID;

--3.
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
GROUP BY ProductID;

--4.
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
GROUP BY ProductID
HAVING SUM(LineTotal) > 50000;

--5.
SELECT ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
GROUP BY ProductID
ORDER BY TotalUang DESC;

--6.
SELECT TOP 10 ProductID, SUM(LineTotal) AS TotalUang
FROM Sales.SalesOrderDetail
GROUP BY ProductID
ORDER BY TotalUang DESC;